<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.co.kosmo.project_back.wishlist.mapper.WishlistMapper">

    <!-- 찜 목록 조회 -->
    <select id="findWishListByUserId" 
            parameterType="int"
            resultType="kr.co.kosmo.project_back.product.dto.ProductDto">

        SELECT
            p.id                AS productId,
            p.product_name      AS productName,
            p.price,         
            p.image_url         AS imageUrl,
            p.origin_name       AS originName,
            p.content,
            1                   AS iswished         <!-- 찜한 상품임을 알리는 -->
        FROM bg_wishlist w  
        JOIN bg_product p ON w.product_id = p.id 
        WHERE w.user_id = #{userId}      
    </select>

    <!-- 찜 여부 확인 -->
    <select id="findWish" resultType="int">
        SELECT COUNT(*)
        FROM bg_wishlist
        WHERE user_id = #{userId}
            AND product_id = #{productId}
    </select>

    <!-- 찜 목록 추가 -->
    <insert id="insertWish">
        INSERT INTO bg_wishlist(user_id, product_id)
        VALUES (#{userId}, #{productId})
    </insert>

    <!-- 찜 목록 삭제 -->
    <delete id="deleteWish">
        DELETE FROM bg_wishlist
        WHERE user_id = #{userId}
            AND product_id = #{productId}
    </delete>

    <!-- 회원 탈퇴 -->
    <delete id="deleteByUserId" parameterType="int">
        DELETE FROM bg_wishlist
        WHERE user_id = #{userId}
    </delete>
</mapper>





