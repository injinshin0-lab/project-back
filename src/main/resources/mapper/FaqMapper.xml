<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.co.kosmo.project_back.faq.mapper.FaqMapper">

    <!-- faq 목록 조회 (검색 + 페이징) -->
    <select id="findFaqList"
            parameterType="kr.co.kosmo.project_back.faq.dto.FaqSearchDto"
            resultType="kr.co.kosmo.project_back.faq.dto.FaqDto">

        SELECT
            id              AS faqId,
            title,
            content,
            created_at      AS createdAt
        FROM Bg_Faq
        <where>
            <if test="keyword != null and keyword != ''">
                (title LIKE '%' || #{keyword} || '%'
                    OR content LIKE '%' || #{keyword} || '%')
            </if>
        </where>
        ORDER BY created_at DESC 
        LIMIT #{size} OFFSET #{offset} 
    </select>  

    <!-- faq 전체 개수 -->  
    <select id="countFaqList"
            parameterType="kr.co.kosmo.project_back.faq.dto.FaqSearchDto"
            resultType="int">

        SELECT COUNT(*)
        FROM Bg_Faq 
        <where>
            <if test="keyword != null and keyword != ''">
                (title LIKE '%' || #{keyword} || '%'
                OR content LIKE '%' || #{keyword} || '%')
            </if>
        </where>
    </select>

    <!-- faq 단건 조회 -->
    <select id="findByFaqId"
            parameterType="int"
            resultType="kr.co.kosmo.project_back.faq.dto.FaqDto">
        SELECT
            id              AS faqId,
            title,
            content,
            created_at      AS createdAt
        FROM Bg_Faq
        WHERE id = #{faqId} 
    </select>
</mapper>



